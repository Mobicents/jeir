<?xml version='1.0'?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "EIR_Server_User_Guide.ent">
%BOOK_ENTITIES;
]>

<chapter id="setup">
	<title>Installation and Running</title>
	<section id="installing_and_using">
		<title>Installing</title>
		<para>A simple way to get started is to download and install binary. This will provide you with all the dependencies you need to get going. 
		You can obtain binary release from &THIS.RELEASE_BINARY_URL;
		</para>
		
		<section id="binary">
			<title>Binary</title>
			<para>The Mobicents jEIR Server is broken down into two modules.</para>
			<para>Binary release has the following layout:</para>
			
			<mediaobject id="binary_layout">
            	<imageobject>
                	<imagedata width="241px" align="center" fileref="images/binnar-structure.png" format="PNG" />
                </imageobject>
                <caption>
                	<para>&THIS.PLATFORM; &THIS.APPLICATION; binary layout.</para>
                </caption>
        	</mediaobject>
        	<note>
            	<title>Note</title>
                <para>X.Y.Z in above layout is the respective release version of binary.</para>
            </note>
            
            <section id="installing_binary">
				<title>Installing &THIS.PLATFORM; &THIS.APPLICATION; Binary</title>
				<para>Unzip the file and run the command:</para>
<programlisting>
[usr]$ ant
</programlisting>
				<note>
					<title>JBOSS_HOME variable</title>
					<para>Configure the JBOSS_HOME variable first pointing to the Mobicents JSLEE installed.</para>
				</note>

				<note>
					<title>Configure SS7 link</title>
					<para>Configure appropriately SS7 link following the Mobicents SS7 docs.</para>
				</note>
			</section>
		</section>
		
		<section id="dependencies">
			<title>Setup from source</title>
			<para>The &THIS.PLATFORM; &THIS.APPLICATION; is an open source project, instructions for building from source are part of the manual! Building from source means you can stay on top with the latest futures.</para>
			<para>&THIS.PLATFORM; &THIS.APPLICATION; works with JDK1.7 and above. You will also need to have the following tools installed. Minimum requirement version numbers provided.</para>
			
			<itemizedlist>
				<listitem>
					<para><literal>Git Client 1.6</literal> : Instructions for using GIT, including install, can be found at <ulink
									url="http://git-scm.com/book" /></para>
				</listitem>		
				<listitem>
					<para><literal>Maven 2.2.1</literal> : Instructions for using Maven, including install, can be found at <ulink
									url="http://maven.apache.org/" /></para>
				</listitem>	
				<listitem>
					<para><literal>Ant 1.7.0</literal> : Instructions for using Ant, including install, can be found at <ulink
									url="http://ant.apache.org" /></para>
				</listitem>	
			</itemizedlist>
			
			<section
			id="source_building">
			<title>Release Source Code Building</title>
			<procedure>
				<step>
					<title>Downloading the source code</title>
					
					<para>Use GIT to clone repository, the base URL is &THIS.TRUNK_SOURCE_CODE_URL;,
						then to checkout specific release version(tag) use <command>git checkout tag_name</command>, lets consider release-&THIS.VERSION;.
					</para>
					<programlisting>
[usr]$ git clone &THIS.TRUNK_SOURCE_CODE_URL;
[usr]$ cd jeir
[usr]$ git checkout release-&THIS.VERSION;
					</programlisting>
					<para>Browse the code online at <ulink url="&THIS.RELEASE_SOURCE_CODE_URL;" /> </para>
				</step>
				<step>
					<title>Building the source code</title>
					
					<para>Now that we have the source the next step is to build and install the source. 
					&THIS.PLATFORM; &THIS.APPLICATION; uses Maven 2 to build the system.
					</para>
										
					<programlisting>
[usr]$ cd jeir
[usr]$ mvn clean install
				    </programlisting>
				    
					<para>Use Ant to build the binary .</para>
					<programlisting>
[usr]$ cd jeir/release
[usr]$ ant
				    </programlisting>

				</step>
			</procedure>
		</section>
			
		</section>
	</section>
	
	<section id="installing_persistence_system">
		<title>Installing Apache Cassandra database</title>
		<para>Download the binary package <ulink url="http://cassandra.apache.org/download/" />. Unzip it and run:</para>
		<programlisting>
./cassandra -f
		</programlisting>
		
		<section id="create_keyspace_cassandra">
			<title>Creating the keyspace at Apache Cassanra</title>
			<para>Use:</para>
			<programlisting> 
$./cqlsh --cql3 
			</programlisting>
			<para>To access the Cassandra CLI. Then type the following commands:</para>
			
			<programlisting>
CREATE KEYSPACE eirdb WITH strategy_class = 'org.apache.cassandra.locator.SimpleStrategy' AND strategy_options:replication_factor='1';
use eirdb;
CREATE TABLE blacklist(imei varchar, imsi varchar, PRIMARY KEY (imei));
			</programlisting>
		</section>
		
		<section id="inserting_imeis_cassandra">
			<title>Inserting IMEI in blackList</title>
			<para>To be able insert new IMEI to be blocked in EIR, you should insert in Cassandra database with the command bellow.</para>
			<programlisting>
INSERT INTO blacklist (imei, imsi) values ('111111111111111', '222222222222222');
			</programlisting>
		</section>
	</section>
	
</chapter>
